---
title: podman使用总结
name: Z.C Yang
date: 2025-09-10 10:00:00 -0500
categories: [容器技术]
tags: [podman]
---


## 容器网络

### 创建网络
```shell
# 创建网络
podman network create es-net

# 查看网络是否创建成功
podman network ls
```

### 运行时连接网络

某些情况下容器已经运行了，但是没有配置好网络，需要使用下述步骤修改网络配置：

```shell
# 语法：podman network connect 网络名称 容器名称
podman network connect es-net elasticsearch7

podman network connect es-net kibana
```

### 查看网络配置

```shell
# 查看网络列表
podman network ls

# 查看网络详情
podman network inspect es-net

# 查看容器网络配置
podman inspect -f '{{.NetworkSettings.Networks}}' kibana
```

## mysql安装

打开podman交互界面方式：
- 在windows teminal中找到podman-machine-default下拉进入
- 在terminal输入wsl相关命令:
```shell
wsl -d podman-machine-default
```

### 拉取mysql镜像

```shell
podman pull mysql:8.0
```

查看本地镜像是否拉取成功:
```shell
podman images
```

### 准备mysql持久化目录

在宿主机上创建目录，用于挂载到 MySQL 容器中，以实现数据的持久化存储，防止容器删除后数据丢失。

```shell
sudo mkdir -p ~/mysql8/{etc/mysql/conf.d,logs,data,mysql-files}
```

检查目录结构，使用ls -R 命令递归查看目录:
```shell
ls -R ~/mysql8
```

### 创建mysql容器

- 执行podman run命令创建容器

```shell
podman run -p 3306:3306 \
		-e MYSQL_ROOT_PASSWORD=root \
		-v /home/user/mysql8/etc/mysql:/etc/mysql:rw \
		-v /home/user/mysql8/data:/var/lib/mysql:rw \
		-v /home/user/mysql8/log:/var/log/mysql:rw \
		-v /home/user/mysql8/mysql-files:/var/lib/mysql-files:rw \
		--name mysql8 \
		docker.io/library/mysql:8
```

- 检查容器运行状态
```shell
podman ps -a
```

### 配置mysql远程连接

- 进行mysql容器
```shell
podman exec -it mysql8 /bin/bash
```

- 登录mysql
```shell
mysql -uroot -p
```

### 执行授权命令

```shell

-- 授权root用户在所有数据库上的所有权限，并允许其从任何主机连接
GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;

-- 刷新权限，使更改立即生效
FLUSH PRIVILEGES;
```

## redis安装

### 拉取redis镜像并安装

```shell
docker run -p 6379:6379 -d redis:latest redis-server
```

## elasticsearch安装

### 桥接网络的创建
```shell
# 创建网络
podman network create es-net

# 查看网络是否创建成功
podman network ls
```

### 安装

本地开发调试的版本为v7，podman主要安装命令为:
```shell
# 拉取镜像
podman pull elasticsearch:7.12.0

# 运行
podman run -d --name elasticsearch7 --network es-net -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" docker.io/library/elasticsearch:7.12.0
```

### 安装`ik_max_word`分词器

进入容器:
```shell
podman exec -it elasticsearch7 /bin/bash
```

在线下载并安装:
```shell
./bin/elasticsearch-plugin install https://get.infini.cloud/elasticsearch/analysis-ik/7.12.0
```

## kibana安装

kibana可以理解为ES的可视化管理工具，版本需要和ES相同，结合上述用到的`elasticsearch:7.12.0`版本，podman主要安装命令为:
```shell
# 拉取镜像
podman pull kibana:7.12.0

# 运行
podman run --name kibana --network es-net -e ELASTICSEARCH_HOSTS=http://127.0.0.1:9200 -p 5601:5601 -d kibana:7.12.0
```

映射配置文件的情况下运行:
```shell
podman run --name kibana --network es-net -p 5601:5601 -v ./kibana.yml:/usr/share/kibana/config/kibana.yml -d kibana:7.12.0 
```

kibana.yml的配置为:
```yml
server.name: kibana
server.host: "0.0.0.0"
elasticsearch.hosts: [ "http://127.0.0.1:9200" ]
monitoring.ui.container.elasticsearch.enabled: true
```



## 参考文章
[podman windows安装指南](https://github.com/containers/podman/blob/main/docs/tutorials/podman-for-windows.md)
[使用podman创建Mysql镜像容器](https://www.cnblogs.com/mhzch/p/19026819)
[docker在自定义网络中安装ElasticSearch和Kibana的步骤](https://www.jb51.net/server/348222bev.htm)
